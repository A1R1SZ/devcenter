{"ast":null,"code":"import{useState,useEffect}from'react';import SearchIcon from'@mui/icons-material/Search';import{styled,alpha}from'@mui/material/styles';import InputBase from'@mui/material/InputBase';import{Box,Paper,List,ListItem,ListItemText}from'@mui/material';import{useNavigate,useLocation}from'react-router-dom';import axios from'axios';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const Search=styled('div')(_ref=>{let{theme}=_ref;return{position:'relative',borderRadius:theme.shape.borderRadius,backgroundColor:alpha(theme.palette.common.white,0.15),'&:hover':{backgroundColor:alpha(theme.palette.common.white,0.25)},width:'100%'};});const SearchIconWrapper=styled('div')(_ref2=>{let{theme}=_ref2;return{padding:theme.spacing(0,2),height:'100%',position:'absolute',display:'flex',alignItems:'center',justifyContent:'center'};});const StyledInputBase=styled(InputBase)(_ref3=>{let{theme}=_ref3;return{color:'white',width:'100%','& .MuiInputBase-input':{padding:theme.spacing(1,1,1,0),paddingLeft:`calc(1em + ${theme.spacing(4)})`,width:'35ch'}};});export default function Searchbar(){const[query,setQuery]=useState('');const[suggestions,setSuggestions]=useState([]);const navigate=useNavigate();const location=useLocation();// ðŸ§¹ Hide suggestions on route change\nuseEffect(()=>{setSuggestions([]);},[location.pathname]);// ðŸ” Fetch suggestions\nuseEffect(()=>{if(query.trim().length>1){const token=localStorage.getItem('token');axios.get(`http://localhost:5000/search?q=${query}`,{headers:{Authorization:`Bearer ${token}`}}).then(res=>setSuggestions(res.data.slice(0,5))).catch(()=>setSuggestions([]));}else{setSuggestions([]);}},[query]);const handleKeyDown=e=>{if(e.key==='Enter'&&query.trim()){navigate(`/search?q=${encodeURIComponent(query)}`);setSuggestions([]);}};const handleSuggestionClick=text=>{navigate(`/search?q=${encodeURIComponent(text)}`);setSuggestions([]);setQuery('');};return/*#__PURE__*/_jsx(Box,{sx:{flexGrow:1,display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsxs(Search,{children:[/*#__PURE__*/_jsx(SearchIconWrapper,{children:/*#__PURE__*/_jsx(SearchIcon,{})}),/*#__PURE__*/_jsx(StyledInputBase,{placeholder:\"Search\\u2026\",value:query,onChange:e=>setQuery(e.target.value),onKeyDown:handleKeyDown}),suggestions.length>0&&/*#__PURE__*/_jsx(Paper,{sx:{position:'absolute',top:'100%',left:0,width:'100%',zIndex:10,mt:1},children:/*#__PURE__*/_jsx(List,{dense:true,children:suggestions.map(item=>/*#__PURE__*/_jsx(ListItem,{button:true,onClick:()=>handleSuggestionClick(item.post_title||item.resource_name),children:/*#__PURE__*/_jsx(ListItemText,{primary:item.post_title||item.resource_name,secondary:/*#__PURE__*/_jsxs(_Fragment,{children:[`by @${item.author_username}`,/*#__PURE__*/_jsx(\"br\",{}),item.resource_name&&item.resource_version?`Resource: ${item.resource_name} v${item.resource_version}`:'']})})},item.post_id))})})]})});}","map":{"version":3,"names":["useState","useEffect","SearchIcon","styled","alpha","InputBase","Box","Paper","List","ListItem","ListItemText","useNavigate","useLocation","axios","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Search","_ref","theme","position","borderRadius","shape","backgroundColor","palette","common","white","width","SearchIconWrapper","_ref2","padding","spacing","height","display","alignItems","justifyContent","StyledInputBase","_ref3","color","paddingLeft","Searchbar","query","setQuery","suggestions","setSuggestions","navigate","location","pathname","trim","length","token","localStorage","getItem","get","headers","Authorization","then","res","data","slice","catch","handleKeyDown","e","key","encodeURIComponent","handleSuggestionClick","text","sx","flexGrow","children","placeholder","value","onChange","target","onKeyDown","top","left","zIndex","mt","dense","map","item","button","onClick","post_title","resource_name","primary","secondary","author_username","resource_version","post_id"],"sources":["C:/Users/AIRISZ/devcenter/frontend/src/components/searchbar.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport { styled, alpha } from '@mui/material/styles';\r\nimport InputBase from '@mui/material/InputBase';\r\nimport { Box, Paper, List, ListItem, ListItemText } from '@mui/material';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nconst Search = styled('div')(({ theme }) => ({\r\n  position: 'relative',\r\n  borderRadius: theme.shape.borderRadius,\r\n  backgroundColor: alpha(theme.palette.common.white, 0.15),\r\n  '&:hover': { backgroundColor: alpha(theme.palette.common.white, 0.25) },\r\n  width: '100%',\r\n}));\r\n\r\nconst SearchIconWrapper = styled('div')(({ theme }) => ({\r\n  padding: theme.spacing(0, 2),\r\n  height: '100%',\r\n  position: 'absolute',\r\n  display: 'flex',\r\n  alignItems: 'center',\r\n  justifyContent: 'center',\r\n}));\r\n\r\nconst StyledInputBase = styled(InputBase)(({ theme }) => ({\r\n  color: 'white',\r\n  width: '100%',\r\n  '& .MuiInputBase-input': {\r\n    padding: theme.spacing(1, 1, 1, 0),\r\n    paddingLeft: `calc(1em + ${theme.spacing(4)})`,\r\n    width: '35ch',\r\n  },\r\n}));\r\n\r\nexport default function Searchbar() {\r\n  const [query, setQuery] = useState('');\r\n  const [suggestions, setSuggestions] = useState([]);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  // ðŸ§¹ Hide suggestions on route change\r\n  useEffect(() => {\r\n    setSuggestions([]);\r\n  }, [location.pathname]);\r\n\r\n  // ðŸ” Fetch suggestions\r\n  useEffect(() => {\r\n    if (query.trim().length > 1) {\r\n      const token = localStorage.getItem('token');\r\n      axios\r\n        .get(`http://localhost:5000/search?q=${query}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        })\r\n        .then((res) => setSuggestions(res.data.slice(0, 5)))\r\n        .catch(() => setSuggestions([]));\r\n    } else {\r\n      setSuggestions([]);\r\n    }\r\n  }, [query]);\r\n\r\n  const handleKeyDown = (e) => {\r\n    if (e.key === 'Enter' && query.trim()) {\r\n      navigate(`/search?q=${encodeURIComponent(query)}`);\r\n      setSuggestions([]);\r\n    }\r\n  };\r\n\r\n  const handleSuggestionClick = (text) => {\r\n    navigate(`/search?q=${encodeURIComponent(text)}`);\r\n    setSuggestions([]);\r\n    setQuery('');\r\n  };\r\n\r\n  return (\r\n    <Box sx={{ flexGrow: 1, display: 'flex', justifyContent: 'center' }}>\r\n      <Search>\r\n        <SearchIconWrapper>\r\n          <SearchIcon />\r\n        </SearchIconWrapper>\r\n        <StyledInputBase\r\n          placeholder=\"Searchâ€¦\"\r\n          value={query}\r\n          onChange={(e) => setQuery(e.target.value)}\r\n          onKeyDown={handleKeyDown}\r\n        />\r\n        {suggestions.length > 0 && (\r\n          <Paper\r\n            sx={{\r\n              position: 'absolute',\r\n              top: '100%',\r\n              left: 0,\r\n              width: '100%',\r\n              zIndex: 10,\r\n              mt: 1,\r\n            }}\r\n          >\r\n            <List dense>\r\n              {suggestions.map((item) => (\r\n                <ListItem\r\n                  key={item.post_id}\r\n                  button\r\n                  onClick={() =>\r\n                    handleSuggestionClick(item.post_title || item.resource_name)\r\n                  }\r\n                >\r\n                  <ListItemText\r\n                    primary={item.post_title || item.resource_name}\r\n                    secondary={\r\n                      <>\r\n                        {`by @${item.author_username}`}<br />\r\n                        {item.resource_name && item.resource_version\r\n                          ? `Resource: ${item.resource_name} v${item.resource_version}`\r\n                          : ''}\r\n                      </>\r\n                    }\r\n                  />\r\n                </ListItem>\r\n              ))}\r\n            </List>\r\n          </Paper>\r\n        )}\r\n      </Search>\r\n    </Box>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}