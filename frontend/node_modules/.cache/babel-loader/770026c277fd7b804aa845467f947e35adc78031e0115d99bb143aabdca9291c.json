{"ast":null,"code":"import React,{createContext,useState,useEffect}from'react';import{jwtDecode}from'jwt-decode';import{jsx as _jsx}from\"react/jsx-runtime\";export const UserContext=/*#__PURE__*/createContext();export const UserProvider=_ref=>{let{children}=_ref;const baseURL=process.env.REACT_APP_API_URL;const[username,setUsername]=useState('');const[token,setToken]=useState(null);const[userID,setUserID]=useState(null);const[role,setRole]=useState('');// ‚úÖ Add role\nconst[refreshCounter,setRefreshCounter]=useState(0);const refreshUser=()=>setRefreshCounter(prev=>prev+1);useEffect(()=>{const storedToken=localStorage.getItem('token');if(storedToken){setToken(storedToken);try{const decoded=jwtDecode(storedToken);if(decoded.userID)setUserID(decoded.userID);fetch(`${baseURL}/get-profile-info`,{headers:{Authorization:`Bearer ${storedToken}`}}).then(res=>res.json()).then(data=>{console.log(\"‚úÖ Profile Info Received:\",data);// üîç DEBUG\nif(data.username)setUsername(data.username);if(data.id)setUserID(data.id);if(data.role){console.log(\"‚úÖ Setting Role:\",data.role);// üîç DEBUG\nsetRole(data.role);}else{console.warn(\"‚ö†Ô∏è No role found in profile info\");}});}catch(err){console.error('Invalid token',err);}}},[refreshCounter]);return/*#__PURE__*/_jsx(UserContext.Provider,{value:{username,setUsername,token,setToken,userID,setUserID,role,setRole,refreshUser},children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","jwtDecode","jsx","_jsx","UserContext","UserProvider","_ref","children","baseURL","process","env","REACT_APP_API_URL","username","setUsername","token","setToken","userID","setUserID","role","setRole","refreshCounter","setRefreshCounter","refreshUser","prev","storedToken","localStorage","getItem","decoded","fetch","headers","Authorization","then","res","json","data","console","log","id","warn","err","error","Provider","value"],"sources":["C:/Users/AIRISZ/devcenter/frontend/src/contexts/UserContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\nimport { jwtDecode } from 'jwt-decode';\r\n\r\nexport const UserContext = createContext();\r\n\r\nexport const UserProvider = ({ children }) => {\r\n  const baseURL = process.env.REACT_APP_API_URL;\r\n  const [username, setUsername] = useState('');\r\n  const [token, setToken] = useState(null);\r\n  const [userID, setUserID] = useState(null);\r\n  const [role, setRole] = useState(''); // ‚úÖ Add role\r\n  const [refreshCounter, setRefreshCounter] = useState(0);\r\n  const refreshUser = () => setRefreshCounter(prev => prev + 1);\r\n\r\n  useEffect(() => {\r\n    const storedToken = localStorage.getItem('token');\r\n    if (storedToken) {\r\n      setToken(storedToken);\r\n      try {\r\n        const decoded = jwtDecode(storedToken);\r\n        if (decoded.userID) setUserID(decoded.userID);\r\n\r\n        fetch(`${baseURL}/get-profile-info`, {\r\n          headers: {\r\n            Authorization: `Bearer ${storedToken}`,\r\n          },\r\n        })\r\n          .then((res) => res.json())\r\n          .then((data) => {\r\n            console.log(\"‚úÖ Profile Info Received:\", data); // üîç DEBUG\r\n            if (data.username) setUsername(data.username);\r\n            if (data.id) setUserID(data.id);\r\n            if (data.role) {\r\n              console.log(\"‚úÖ Setting Role:\", data.role);  // üîç DEBUG\r\n              setRole(data.role);\r\n            } else {\r\n              console.warn(\"‚ö†Ô∏è No role found in profile info\");\r\n            }\r\n          });\r\n      } catch (err) {\r\n        console.error('Invalid token', err);\r\n      }\r\n    }\r\n  }, [refreshCounter]);\r\n\r\n  return (\r\n    <UserContext.Provider\r\n      value={{\r\n        username,\r\n        setUsername,\r\n        token,\r\n        setToken,\r\n        userID,\r\n        setUserID,\r\n        role,  \r\n        setRole,\r\n        refreshUser,\r\n      }}\r\n    >\r\n      {children}\r\n    </UserContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACjE,OAASC,SAAS,KAAQ,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEvC,MAAO,MAAM,CAAAC,WAAW,cAAGN,aAAa,CAAC,CAAC,CAE1C,MAAO,MAAM,CAAAO,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAAAE,OAAO,CAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,CAC7C,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACe,KAAK,CAAEC,QAAQ,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAACiB,MAAM,CAAEC,SAAS,CAAC,CAAGlB,QAAQ,CAAC,IAAI,CAAC,CAC1C,KAAM,CAACmB,IAAI,CAAEC,OAAO,CAAC,CAAGpB,QAAQ,CAAC,EAAE,CAAC,CAAE;AACtC,KAAM,CAACqB,cAAc,CAAEC,iBAAiB,CAAC,CAAGtB,QAAQ,CAAC,CAAC,CAAC,CACvD,KAAM,CAAAuB,WAAW,CAAGA,CAAA,GAAMD,iBAAiB,CAACE,IAAI,EAAIA,IAAI,CAAG,CAAC,CAAC,CAE7DvB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAwB,WAAW,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CACjD,GAAIF,WAAW,CAAE,CACfT,QAAQ,CAACS,WAAW,CAAC,CACrB,GAAI,CACF,KAAM,CAAAG,OAAO,CAAG1B,SAAS,CAACuB,WAAW,CAAC,CACtC,GAAIG,OAAO,CAACX,MAAM,CAAEC,SAAS,CAACU,OAAO,CAACX,MAAM,CAAC,CAE7CY,KAAK,CAAC,GAAGpB,OAAO,mBAAmB,CAAE,CACnCqB,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUN,WAAW,EACtC,CACF,CAAC,CAAC,CACCO,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEG,IAAI,EAAK,CACdC,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAEF,IAAI,CAAC,CAAE;AAC/C,GAAIA,IAAI,CAACtB,QAAQ,CAAEC,WAAW,CAACqB,IAAI,CAACtB,QAAQ,CAAC,CAC7C,GAAIsB,IAAI,CAACG,EAAE,CAAEpB,SAAS,CAACiB,IAAI,CAACG,EAAE,CAAC,CAC/B,GAAIH,IAAI,CAAChB,IAAI,CAAE,CACbiB,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAEF,IAAI,CAAChB,IAAI,CAAC,CAAG;AAC5CC,OAAO,CAACe,IAAI,CAAChB,IAAI,CAAC,CACpB,CAAC,IAAM,CACLiB,OAAO,CAACG,IAAI,CAAC,kCAAkC,CAAC,CAClD,CACF,CAAC,CAAC,CACN,CAAE,MAAOC,GAAG,CAAE,CACZJ,OAAO,CAACK,KAAK,CAAC,eAAe,CAAED,GAAG,CAAC,CACrC,CACF,CACF,CAAC,CAAE,CAACnB,cAAc,CAAC,CAAC,CAEpB,mBACEjB,IAAA,CAACC,WAAW,CAACqC,QAAQ,EACnBC,KAAK,CAAE,CACL9B,QAAQ,CACRC,WAAW,CACXC,KAAK,CACLC,QAAQ,CACRC,MAAM,CACNC,SAAS,CACTC,IAAI,CACJC,OAAO,CACPG,WACF,CAAE,CAAAf,QAAA,CAEDA,QAAQ,CACW,CAAC,CAE3B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}